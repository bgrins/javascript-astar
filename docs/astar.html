<!DOCTYPE html>  <html> <head>   <title>astar.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="astar.html">                 astar.js               </a>                                           <a class="source" href="graph.html">                 graph.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               astar.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>javascript-astar
http://github.com/bgrins/javascript-astar
Freely distributable under the MIT License.
Implements the astar search algorithm in javascript using a binary heap.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">astar</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">grid</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">xl</span> <span class="o">=</span> <span class="nx">grid</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="nx">xl</span><span class="p">;</span> <span class="nx">x</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">yl</span> <span class="o">=</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="nx">yl</span><span class="p">;</span> <span class="nx">y</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">y</span><span class="p">];</span>
                <span class="nx">node</span><span class="p">.</span><span class="nx">f</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="nx">node</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="nx">node</span><span class="p">.</span><span class="nx">h</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="nx">node</span><span class="p">.</span><span class="nx">cost</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">type</span><span class="p">;</span>
                <span class="nx">node</span><span class="p">.</span><span class="nx">visited</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                <span class="nx">node</span><span class="p">.</span><span class="nx">closed</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                <span class="nx">node</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">heap</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">BinaryHeap</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span> 
            <span class="k">return</span> <span class="nx">node</span><span class="p">.</span><span class="nx">f</span><span class="p">;</span> 
        <span class="p">});</span>
    <span class="p">},</span>
    <span class="nx">search</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">grid</span><span class="p">,</span> <span class="nx">start</span><span class="p">,</span> <span class="nx">end</span><span class="p">,</span> <span class="nx">diagonal</span><span class="p">,</span> <span class="nx">heuristic</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">astar</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nx">grid</span><span class="p">);</span>
        <span class="nx">heuristic</span> <span class="o">=</span> <span class="nx">heuristic</span> <span class="o">||</span> <span class="nx">astar</span><span class="p">.</span><span class="nx">manhattan</span><span class="p">;</span>
        <span class="nx">diagonal</span> <span class="o">=</span> <span class="o">!!</span><span class="nx">diagonal</span><span class="p">;</span>

        <span class="kd">var</span> <span class="nx">openHeap</span> <span class="o">=</span> <span class="nx">astar</span><span class="p">.</span><span class="nx">heap</span><span class="p">();</span>

        <span class="nx">openHeap</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">start</span><span class="p">);</span>

        <span class="k">while</span><span class="p">(</span><span class="nx">openHeap</span><span class="p">.</span><span class="nx">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Grab the lowest f(x) to process next.  Heap keeps this sorted for us.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="kd">var</span> <span class="nx">currentNode</span> <span class="o">=</span> <span class="nx">openHeap</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>End case -- result has been found, return the traced path.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span><span class="p">(</span><span class="nx">currentNode</span> <span class="o">===</span> <span class="nx">end</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">curr</span> <span class="o">=</span> <span class="nx">currentNode</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="p">[];</span>
                <span class="k">while</span><span class="p">(</span><span class="nx">curr</span><span class="p">.</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">ret</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">curr</span><span class="p">);</span>
                    <span class="nx">curr</span> <span class="o">=</span> <span class="nx">curr</span><span class="p">.</span><span class="nx">parent</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">return</span> <span class="nx">ret</span><span class="p">.</span><span class="nx">reverse</span><span class="p">();</span>
            <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Normal case -- move currentNode from open to closed, process each of its neighbors.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">currentNode</span><span class="p">.</span><span class="nx">closed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Find all neighbors for the current node. Optionally find diagonal neighbors as well (false by default).</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="kd">var</span> <span class="nx">neighbors</span> <span class="o">=</span> <span class="nx">astar</span><span class="p">.</span><span class="nx">neighbors</span><span class="p">(</span><span class="nx">grid</span><span class="p">,</span> <span class="nx">currentNode</span><span class="p">,</span> <span class="nx">diagonal</span><span class="p">);</span>

            <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">il</span> <span class="o">=</span> <span class="nx">neighbors</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">il</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">neighbor</span> <span class="o">=</span> <span class="nx">neighbors</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

                <span class="k">if</span><span class="p">(</span><span class="nx">neighbor</span><span class="p">.</span><span class="nx">closed</span> <span class="o">||</span> <span class="nx">neighbor</span><span class="p">.</span><span class="nx">isWall</span><span class="p">())</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Not a valid node to process, skip to next neighbor.</p>             </td>             <td class="code">               <div class="highlight"><pre>                    <span class="k">continue</span><span class="p">;</span>
                <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>The g score is the shortest distance from start to current node.
We need to check if the path we have arrived at this neighbor is the shortest one we have seen yet.</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="kd">var</span> <span class="nx">gScore</span> <span class="o">=</span> <span class="nx">currentNode</span><span class="p">.</span><span class="nx">g</span> <span class="o">+</span> <span class="nx">neighbor</span><span class="p">.</span><span class="nx">cost</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">beenVisited</span> <span class="o">=</span> <span class="nx">neighbor</span><span class="p">.</span><span class="nx">visited</span><span class="p">;</span>

                <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">beenVisited</span> <span class="o">||</span> <span class="nx">gScore</span> <span class="o">&lt;</span> <span class="nx">neighbor</span><span class="p">.</span><span class="nx">g</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Found an optimal (so far) path to this node.  Take score for node to see how good it is.</p>             </td>             <td class="code">               <div class="highlight"><pre>                    <span class="nx">neighbor</span><span class="p">.</span><span class="nx">visited</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="nx">neighbor</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="nx">currentNode</span><span class="p">;</span>
                    <span class="nx">neighbor</span><span class="p">.</span><span class="nx">h</span> <span class="o">=</span> <span class="nx">neighbor</span><span class="p">.</span><span class="nx">h</span> <span class="o">||</span> <span class="nx">heuristic</span><span class="p">(</span><span class="nx">neighbor</span><span class="p">.</span><span class="nx">pos</span><span class="p">,</span> <span class="nx">end</span><span class="p">.</span><span class="nx">pos</span><span class="p">);</span>
                    <span class="nx">neighbor</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="nx">gScore</span><span class="p">;</span>
                    <span class="nx">neighbor</span><span class="p">.</span><span class="nx">f</span> <span class="o">=</span> <span class="nx">neighbor</span><span class="p">.</span><span class="nx">g</span> <span class="o">+</span> <span class="nx">neighbor</span><span class="p">.</span><span class="nx">h</span><span class="p">;</span>

                    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">beenVisited</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Pushing to heap will put it in proper place based on the 'f' value.</p>             </td>             <td class="code">               <div class="highlight"><pre>                        <span class="nx">openHeap</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">neighbor</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Already seen the node, but since it has been rescored we need to reorder it in the heap</p>             </td>             <td class="code">               <div class="highlight"><pre>                        <span class="nx">openHeap</span><span class="p">.</span><span class="nx">rescoreElement</span><span class="p">(</span><span class="nx">neighbor</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>No result was found - empty array signifies failure to find path.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">return</span> <span class="p">[];</span>
    <span class="p">},</span>
    <span class="nx">manhattan</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">pos0</span><span class="p">,</span> <span class="nx">pos1</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>See list of heuristics: http://theory.stanford.edu/~amitp/GameProgramming/Heuristics.html</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">var</span> <span class="nx">d1</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span> <span class="p">(</span><span class="nx">pos1</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">pos0</span><span class="p">.</span><span class="nx">x</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">d2</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span> <span class="p">(</span><span class="nx">pos1</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="nx">pos0</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">d1</span> <span class="o">+</span> <span class="nx">d2</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">neighbors</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">grid</span><span class="p">,</span> <span class="nx">node</span><span class="p">,</span> <span class="nx">diagonals</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>West</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="nx">y</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">ret</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="nx">y</span><span class="p">]);</span>
        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>East</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="nx">y</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">ret</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="nx">y</span><span class="p">]);</span>
        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>South</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">y</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">ret</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">y</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>North</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">y</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">ret</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="p">][</span><span class="nx">y</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">diagonals</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Southwest</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="nx">y</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
                <span class="nx">ret</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="nx">y</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
            <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Southeast</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="nx">y</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
                <span class="nx">ret</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="nx">y</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
            <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Northwest</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="nx">y</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
                <span class="nx">ret</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="nx">y</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span>
            <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Northeast</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="nx">y</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
                <span class="nx">ret</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">x</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="nx">y</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span>
            <span class="p">}</span>

        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 